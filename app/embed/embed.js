var AS_Widget,scriptElement;void 0===window.AS_Widget?(AS_Widget={BASE_URL:"https://app-sorteos.com",WIDGET_ATTRIBUTE:"data-as-widget",SLIDER_ATTRIBUTE:"data-as-slider",POPUP_ATTRIBUTE:"data-as-popup",SLIDER_OPEN_ATTRIBUTE:"data-as-open",SLIDER_OPEN_VAL_ATTRIBUTE:"data-as-open-value",CUSTOM_TRIGGER_ATTRIBUTE:"data-as-trigger",APP_TYPE_ATTRIBUTE:"data-as-app",EMBED_TYPE_WIDGET:"widget",EMBED_TYPE_SLIDER:"slider",EMBED_TYPE_POPUP:"popup",config:{},metadata:{},cookie:null,initialize:function(e){e?AS_Widget.fetchConfig(e):AS_Widget.initializeElements()},fetchConfig:function(e){const i=new XMLHttpRequest;e=AS_Widget.BASE_URL+"/api/v2/promotions/"+e+"/widget";i.open("GET",e),i.send(),i.onreadystatechange=function(e){var t;4===i.readyState&&200===i.status&&(t=JSON.parse(i.responseText),AS_Widget.config=t.data,AS_Widget.cookie="as_"+AS_Widget.config.hash+"_"+AS_Widget.config.cookie,AS_Widget.initializeElements())}},initializeElements:function(){AS_Widget.config.id&&AS_Widget.launch(),AS_Widget.initializeWidgets()},launch:function(){var e=AS_Widget.config.hash,t=document.body;return!!AS_Widget.config.is_active&&((!AS_Widget.getCookie(AS_Widget.cookie)||-1===AS_Widget.config.cookie_expiration)&&(AS_Widget.metadata[e]={hash:e,app_type:AS_Widget.config.app,parent:t,embed_type:AS_Widget.config.embed_type,open:AS_Widget.config.embed_action,open_value:AS_Widget.config.embed_action_value,is_visible:!1,has_been_shown:!1,iframe_loaded:!1},void("slider"===AS_Widget.config.embed_type?AS_Widget.createSlider(e,t,"slider.css"):"popup"===AS_Widget.config.embed_type?AS_Widget.createPopup(e,t,"popup.css"):"fullpage"===AS_Widget.config.embed_type&&AS_Widget.createPopup(e,t,"fullpage.css"))))},initializeWidgets:function(){var a=document.querySelectorAll("["+AS_Widget.WIDGET_ATTRIBUTE+"]");Array.from(a).forEach(function(e){var t,i=e;a.length&&(t=i.getAttribute(AS_Widget.WIDGET_ATTRIBUTE),e=i.getAttribute(AS_Widget.APP_TYPE_ATTRIBUTE),AS_Widget.metadata[t]={hash:t,app_type:e,parent:i},AS_Widget.createWidget(t,i,"widget.css"))})},createWidget:function(e,t,i){i&&AS_Widget.includeCss(i);i=document.createElement("div"),e=AS_Widget.createIframe(e,AS_Widget.EMBED_TYPE_WIDGET);i.className="as-v1-widget",i.appendChild(e),t.appendChild(i)},initializeSliders:function(){var d=document.querySelectorAll("["+AS_Widget.SLIDER_ATTRIBUTE+"]");Array.from(d).forEach(function(e){var t,i,a,n=e;d.length&&(t=n.getAttribute(AS_Widget.SLIDER_ATTRIBUTE),i=n.getAttribute(AS_Widget.APP_TYPE_ATTRIBUTE),a=n.getAttribute(AS_Widget.SLIDER_OPEN_ATTRIBUTE),e=n.getAttribute(AS_Widget.SLIDER_OPEN_VAL_ATTRIBUTE),AS_Widget.config.hash&&AS_Widget.config.hash===t||(AS_Widget.metadata[t]={hash:t,app_type:i,parent:n,open:a,open_value:e,is_visible:!1,has_been_shown:!1,iframe_loaded:!1},AS_Widget.createSlider(t,n,"slider.css")))})},createSlider:function(e,t,i){i&&AS_Widget.includeCss(i);var a=document.createElement("div"),n=AS_Widget.createIframe(e,AS_Widget.EMBED_TYPE_SLIDER),i=document.createElement("div");i.className="as-v1-slider-overlay",n.appendChild(AS_Widget.createCloseButton(e)),a.className="as-v1-slider",a.id="as_embed_"+e,a.appendChild(i),a.appendChild(n),t.appendChild(a),AS_Widget.launchSlidersAndPopups(e)},initializePopups:function(){var d=document.querySelectorAll("["+AS_Widget.POPUP_ATTRIBUTE+"]");Array.from(d).forEach(function(e){var t,i,a,n=e;d.length&&(t=n.getAttribute(AS_Widget.POPUP_ATTRIBUTE),i=n.getAttribute(AS_Widget.APP_TYPE_ATTRIBUTE),a=n.getAttribute(AS_Widget.SLIDER_OPEN_ATTRIBUTE),e=n.getAttribute(AS_Widget.SLIDER_OPEN_VAL_ATTRIBUTE),AS_Widget.config.hash&&AS_Widget.config.hash===t||(AS_Widget.metadata[t]={hash:t,app_type:i,parent:n,open:a,open_value:e,is_visible:!1,has_been_shown:!1,iframe_loaded:!1},AS_Widget.createPopup(t,n,"popup.css")))})},createPopup:function(e,t,i){i&&AS_Widget.includeCss(i);var a=document.createElement("div"),n=AS_Widget.createIframe(e,AS_Widget.EMBED_TYPE_POPUP),i=document.createElement("div");i.className="as-v1-popup-overlay",a.className="as-v1-popup",a.id="as_embed_"+e,n.appendChild(AS_Widget.createCloseButton(e)),a.appendChild(i),a.appendChild(n),t.appendChild(a),AS_Widget.launchSlidersAndPopups(e)},createCloseButton:function(e){var t=document.createElement("button");return t.className="as-v1-close-icon",t.innerHTML="&times;",t.onclick=AS_Widget.closeSlider.bind(this,e),t},launchSlidersAndPopups:function(e){var t=AS_Widget.getMetadata(e);if(t.open)switch(t.open){case"time":var i=1e3*parseInt(t.open_value);setTimeout(function(){AS_Widget.showSlider(t.hash)},i);break;case"load":if(!t.iframe_loaded&&"fullpage"!==t.embed_type)return;AS_Widget.onPageLoad(function(){AS_Widget.showSlider(t.hash)});break;case"scroll":AS_Widget.trackPageScroll(t.open_value,function(){AS_Widget.showSlider(t.hash)});break;case"exit":AS_Widget.onExitIntent(function(){AS_Widget.showSlider(t.hash)});break;case"button":AS_Widget.addTriggerListener(t.hash)}},showSlider:function(e){var t=AS_Widget.getMetadata(e),i=AS_Widget.getWidget(e);if((t.is_visible||t.has_been_shown)&&"button"!==t.open)return!1;AS_Widget.setMetadata(e,"is_visible",!0),AS_Widget.setMetadata(e,"has_been_shown",!0),i.classList.add("visible"),AS_Widget.setCookie(AS_Widget.cookie,Date.now(),AS_Widget.config.cookie_expiration)},closeSlider:function(e){var t=AS_Widget.getWidget(e),i=AS_Widget.getIframe(e);AS_Widget.setMetadata(e,"is_visible",!1),t.classList.remove("visible"),i&&i.contentWindow.postMessage({from:"widget",action:"closed",data:{}})},getWidget:function(e){return document.getElementById("as_embed_"+e)||null},getIframe:function(e){return document.getElementById("as_embed_"+e).querySelector("iframe")||null},createIframe:function(e,t){var i=document.createElement("iframe"),a=document.createElement("div"),n=AS_Widget.getMetadata(e),n=AS_Widget.getIframeSrcParams(t,n);return i.className="as-v1-iframe",i.src=AS_Widget.BASE_URL+"/play/"+e+"?"+n,i.id="i_"+e,a.className="as-v1-iframe-wrapper",i.addEventListener("load",function(){AS_Widget.setMetadata(e,"iframe_loaded",!0),AS_Widget.launchSlidersAndPopups(e)}),t===AS_Widget.EMBED_TYPE_SLIDER&&(a.style.transform="translateX(-110%)"),t===AS_Widget.EMBED_TYPE_POPUP&&(a.style.display="none"),a.appendChild(i),a},getMetadata:function(e){return AS_Widget.metadata&&AS_Widget.metadata[e]?AS_Widget.metadata[e]:{}},setMetadata:function(e,t,i){AS_Widget.metadata&&AS_Widget.metadata[e]&&(AS_Widget.metadata[e][t]=i)},getIframeSrcParams:function(e,i){return new URLSearchParams({"embed-type":e,utm_source:"embed-sdk",utm_medium:i.app_type||"",utm_campaign:null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.hostname.replace(/^www\./,""),utm_term:e}).toString()},includeCss:function(e){var t=AS_Widget.BASE_URL+"/embed/"+e;document.querySelector('link[href="'+t+'"]')||((e=document.createElement("link")).rel="stylesheet",e.href=t,document.head.append(e))},trackPageScroll:function(t,i){__scrollHandler=function(){var e=document.documentElement.scrollHeight,e=(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)/(e-window.innerHeight)*100;t<=e&&(window.removeEventListener("scroll",__scrollHandler),i(e))},window.addEventListener("scroll",__scrollHandler)},onExitIntent:function(t){document.addEventListener("mouseout",e=>{e.toElement||e.relatedTarget||t()})},onPageLoad:function(e){"complete"===document.readyState?e():window.addEventListener("load",function(){e()})},addTriggerListener:function(e){var t=document.querySelectorAll("["+AS_Widget.CUSTOM_TRIGGER_ATTRIBUTE+"]");Array.from(t).forEach(function(e){var t=e.getAttribute(AS_Widget.CUSTOM_TRIGGER_ATTRIBUTE);e.addEventListener("click",function(e){e&&e.preventDefault(),AS_Widget.showSlider(t)})})},setCookie:function(e,t,i){var a,n="";i&&((a=new Date).setTime(a.getTime()+24*i*60*60*1e3),n="; expires="+a.toUTCString()),document.cookie=e+"="+(t||"")+n+"; path=/"},getCookie:function(e){for(var t=e+"=",i=document.cookie.split(";"),a=0;a<i.length;a++){for(var n=i[a];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}},promotion_id=(scriptElement=document.currentScript||function(){var e=document.getElementsByTagName("script");return e[e.length-1]}()).getAttribute("data-promotion"),AS_Widget.initialize(promotion_id)):console.log("window.AS_Widget already loaded");